"use strict";(self["webpackChunkpoetrymirror"]=self["webpackChunkpoetrymirror"]||[]).push([[652],{1652:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var s=a(6252),l=a(3577),i=a(9963);const n=e=>((0,s.dD)("data-v-1a941b3a"),e=e(),(0,s.Cn)(),e),o={class:"box"},r={class:"tag"},c={class:"Text"},p=(0,s.Uk)("返回首页"),d=n((()=>(0,s._)("div",{class:"yuan"},null,-1))),h=n((()=>(0,s._)("h1",{class:"title",id:"title-for"},"寻诗",-1))),u={class:"tags"},g=["onClick"],m={class:"input-btn"},y=n((()=>(0,s._)("label",{class:"upload_img",for:"file"},null,-1))),v=n((()=>(0,s._)("span",{class:"text"},"搜索",-1))),f=[v],w=n((()=>(0,s._)("div",null,[(0,s._)("i",{class:"dividing-line",id:"start"})],-1))),_={class:"poems"},k={class:"title"},b={class:"poet"},C=["innerHTML","id"],z=["onClick"],A=["onClick"],P=["onClick"],$={class:"pagination"};function L(e,t,a,n,v,L){const V=(0,s.up)("router-link"),x=(0,s.up)("el-input"),B=(0,s.up)("el-pagination");return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",null,[(0,s._)("div",r,[(0,s._)("span",c,[(0,s.Wm)(V,{to:"/"},{default:(0,s.w5)((()=>[p])),_:1})])]),d]),h,(0,s._)("nav",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(v.tags,((e,t)=>((0,s.wg)(),(0,s.iD)("span",{class:(0,l.C_)(["item",t===v.typeValue?"checked":""]),key:t,onClick:e=>L.getPoemsBLabel(1,5,t)},(0,l.zw)(e),11,g)))),128))]),(0,s._)("div",m,[(0,s.Wm)(x,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e),placeholder:""},null,8,["modelValue"]),y,(0,s._)("input",{type:"file",name:"file",id:"file",class:"upload",onChange:t[1]||(t[1]=(...e)=>L.update&&L.update(...e))},null,32),(0,s._)("button",{class:"btn",onClick:t[2]||(t[2]=(...e)=>L.search&&L.search(...e))},f)]),w,(0,s._)("div",_,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(v.poety,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{class:"drop-shadow",key:t},[(0,s._)("h4",k,(0,l.zw)(e.name),1),(0,s._)("h4",b,(0,l.zw)(e["poet"]),1),(0,s._)("div",{class:(0,l.C_)(["content",v.displayAll[t]]),innerHTML:e.content,id:"content"+e.id},null,10,C),(0,s._)("button",{class:"play",onClick:t=>L.audioPlay(e.content)},"播放",8,z),(0,s.wy)((0,s._)("div",{class:"more",onClick:e=>L.more(t)},"展开",8,A),[[i.F8,L.countBr(e.content)&&""===v.displayAll[t]]]),(0,s.wy)((0,s._)("div",{class:"reduce",onClick:e=>L.reduce(t)},"收起",8,P),[[i.F8,L.countBr(e.content)&&""!==v.displayAll[t]]])])))),128)),(0,s._)("div",$,[(0,s.Wm)(B,{"hide-on-single-page":v.hidePage,class:"pagination-1","current-page":v.page,"onUpdate:current-page":t[3]||(t[3]=e=>v.page=e),"page-size":v.size,"onUpdate:page-size":t[4]||(t[4]=e=>v.size=e),background:"",layout:"prev, pager, next",total:v.len,"onUpdate:total":t[5]||(t[5]=e=>v.len=e),onCurrentChange:L.changeClick},null,8,["hide-on-single-page","current-page","page-size","total","onCurrentChange"])])])])}var V=a(4002),x=a(3028),B={name:"forPoetry",data(){return{hidePage:!1,page:1,len:0,typeValue:-1,size:5,value:"",tags:["全部","先秦","五代","魏晋","南北朝","两汉","唐代","宋代","元代","明代","清代","诗经","楚辞","乐府","春天","夏天","秋天","冬天","写雨","写风","写花","梅花","荷花","菊花","写山","写水","长江","黄河","儿童","写鸟","写马","写景","写人","山水","写山","写水","写雪","月亮","写风","边塞","地名","节日","春节","元宵","寒食","清明","咏物","女子","春天","秋天","赞美","春节","三曹","元宵节","清明节","端午","中秋","重阳","七夕","寒食","抒情","婉约","抒怀","思念","爱情","送别","思乡","离别","怀人","友情","相思","孤独","励志","豪放"],poety:[],type:1,audio:null,displayAll:new Array(5).fill("")}},mounted(){V.Z.emit("bus",!1);let e=this.$route.params.data;void 0!==e?this.poety=JSON.parse(e):(this.typeValue=0,this.getPoems(1,this.size)),this.hidePage=!0},unmounted(){V.Z.emit("bus",!0),null!==this.audio&&this.audio.pause()},methods:{more(e){this.displayAll[e]="displayAll"},reduce(e){this.displayAll[e]=""},update(e){let t=e.target.files[0],a=new FormData;a.append("img",t);let s={headers:{"Content-Type":"multipart/form-data"}};const l=x.kN.service({fullscreen:!0});let i="/imgUpload/picPoem/";this.$axios.post(i,a,s).then((e=>{this.poety=e.data.data,this.len=1,l.close()})).catch((e=>{this.$message.error(`发生错误，错误原因为${e}`),l.close()}))},changeClick(){1===this.type?this.getPoems(this.page,this.size).then((()=>{document.getElementById("start").scrollIntoView(),this.displayAll=new Array(this.size).fill("")})):this.getPoemsBLabel(this.page,this.size,this.typeValue).then((()=>{document.getElementById("start").scrollIntoView(),this.displayAll=new Array(this.size).fill("")}))},async getPoems(e,t){1===e&&1!==this.page&&(this.page=1);const a=x.kN.service({fullscreen:!0});await this.$axios({url:"/api/poemsList/",method:"get",params:{page:e,size:t}}).then((e=>{this.poety=e.data.data,this.len=e.data.totalLen,a.close()})).catch((e=>{this.$message.error(`发生错误，错误原因为${e}`),a.close()}))},async getPoemsBLabel(e,t,a){this.typeValue=a,1===e&&1!==this.page&&(this.page=1),this.type=2;const s=x.kN.service({fullscreen:!0});await this.$axios({url:"/api/multiPoem/",method:"get",params:{page:e,size:t,label:this.tags[a]}}).then((e=>{this.poety=e.data.data,this.len=e.data.totalLen,s.close()})).catch((e=>{this.$message.error(`发生错误，错误原因为${e}`),s.close()}))},search(){1!==this.page&&(this.page=1);const e=x.kN.service({fullscreen:!0});this.$axios({url:"/model/trans/",method:"get",params:{search:this.value}}).then((t=>{this.poety=t.data,this.len=1,this.displayAll=new Array(this.size).fill(""),e.close()})).catch((t=>{this.$message.error(`发生错误，错误原因为${t}`),e.close()}))},audioPlay(e){e=e.replaceAll("<br>",""),this.$axios({method:"post",url:"/api/readPoem/?poem="+e,responseType:"arraybuffer"}).then((e=>{let t=window.URL.createObjectURL(new Blob([e.data]));try{null==this.audio&&(this.audio=new Audio),t&&(this.audio.src=t,this.audio.play())}catch(a){console.log(a)}})).catch((e=>{console.log(e)}))},countBr(e){let t=e.split("<br>"),a=t.length;for(const s in t){let e=Math.floor(t[s].length/40);a+=e}return a>5}}},U=a(3744);const D=(0,U.Z)(B,[["render",L],["__scopeId","data-v-1a941b3a"]]);var I=D}}]);
//# sourceMappingURL=652.c30e059f.js.map