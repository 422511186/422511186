"use strict";(self["webpackChunkpoetrymirror"]=self["webpackChunkpoetrymirror"]||[]).push([[453],{2453:function(s,e,t){t.r(e),t.d(e,{default:function(){return W}});var i=t(6252),o=t(3577),n=t(9963);const l=s=>((0,i.dD)("data-v-18c91b50"),s=s(),(0,i.Cn)(),s),c={class:"box"},a={class:"tag"},r={class:"Text"},h=(0,i.Uk)("返回首页"),u=l((()=>(0,i._)("div",{class:"yuan"},null,-1))),d={class:"title",id:"title-ai"},m={key:0},_={class:"time-box"},x={class:"time-count"},v={class:"time"},w={class:"rules"},g={class:"rules-text"},b=l((()=>(0,i._)("i",{class:"dividing-line"},null,-1))),y={class:"btn-box"},p={key:1},k={class:"question-box"},S={class:"question"},f={class:"count"},z={class:"score"},I={class:"m"},U=l((()=>(0,i._)("span",{class:"maohao"},":",-1))),q={class:"dui"},C={class:"q-index"},A={class:"send-box"},M=["disabled"],D={key:2},O={class:"result-box"},T={class:"result-image-victory"},E={class:"result-image-fail"},$={class:"Answers"},F={class:"left"},N=l((()=>(0,i._)("span",{style:{color:"rgb(105, 88, 255)"}},"我方",-1))),Q={class:"right"},G=l((()=>(0,i._)("span",{style:{color:"rgb(252, 17, 37)"}},"敌方",-1))),J=l((()=>(0,i._)("i",{class:"dividing-line"},null,-1))),V={class:"btn-box"};function P(s,e,t,l,P,R){const H=(0,i.up)("router-link"),L=(0,i.up)("el-input");return(0,i.wg)(),(0,i.iD)("div",c,[(0,i._)("div",null,[(0,i._)("div",a,[(0,i._)("span",r,[(0,i.Wm)(H,{to:"/"},{default:(0,i.w5)((()=>[h])),_:1})])]),u]),(0,i._)("h1",d,(0,o.zw)(P.const_variable.title),1),1===P.v_box?((0,i.wg)(),(0,i.iD)("div",m,[(0,i._)("div",_,[(0,i._)("div",x,[(0,i.wy)((0,i._)("div",{class:"title-2"},(0,o.zw)(P.const_variable.title_2[0]),513),[[n.F8,!P.v_show]]),(0,i.wy)((0,i._)("div",{class:"title-2"},(0,o.zw)(P.const_variable.title_2[1]),513),[[n.F8,P.v_show]]),(0,i._)("div",v,(0,o.zw)(Math.floor(P.const_variable.time/60))+" : "+(0,o.zw)(P.const_variable.time%60),1)])]),(0,i._)("div",w,[(0,i._)("div",g,(0,o.zw)(P.const_variable.rule),1)]),b,(0,i._)("div",y,[(0,i.wy)((0,i._)("button",{class:"btn",onClick:e[0]||(e[0]=(...s)=>R.matchUser&&R.matchUser(...s))},"开始匹配",512),[[n.F8,!P.v_show]]),(0,i.wy)((0,i._)("button",{class:"btn",onClick:e[1]||(e[1]=(...s)=>R.cancelMatch&&R.cancelMatch(...s))},"取消匹配",512),[[n.F8,P.v_show]])])])):(0,i.kq)("",!0),2===P.v_box?((0,i.wg)(),(0,i.iD)("div",p,[(0,i._)("div",k,[(0,i._)("div",S,[(0,i._)("span",f,(0,o.zw)(P.time),1),(0,i._)("div",z,[(0,i._)("span",I,(0,o.zw)(P.myScore),1),U,(0,i._)("span",q,(0,o.zw)(P.score),1)]),(0,i._)("div",C,(0,o.zw)(P.index+1)+"/10 ",1),(0,i._)("h2",null,(0,o.zw)(P.questions[P.index].name),1),(0,i._)("h4",null,(0,o.zw)(P.questions[P.index].poet),1),(0,i._)("h1",null,(0,o.zw)(P.questions[P.index].question),1)])]),(0,i._)("div",A,[(0,i._)("button",{class:"commit",style:{"margin-right":"50px"},onClick:e[2]||(e[2]=(...s)=>R.preQuestion&&R.preQuestion(...s))},"上一题"),(0,i.Wm)(L,{class:"msg",disabled:P.isDis[P.index],modelValue:P.value[P.index],"onUpdate:modelValue":e[3]||(e[3]=s=>P.value[P.index]=s),placeholder:"在此输入..."},null,8,["disabled","modelValue"]),(0,i._)("button",{class:"commit",style:{"margin-left":"50px"},onClick:e[4]||(e[4]=(...s)=>R.nextQuestion&&R.nextQuestion(...s))},"下一题")]),(0,i._)("button",{class:"commit",style:{"margin-top":"20px"},onClick:e[5]||(e[5]=s=>R.commit(P.index)),disabled:P.isDis[P.index]},"提交",8,M)])):(0,i.kq)("",!0),3===P.v_box?((0,i.wg)(),(0,i.iD)("div",D,[(0,i._)("div",O,[(0,i.wy)((0,i._)("div",T,null,512),[[n.F8,P.score_show]]),(0,i.wy)((0,i._)("div",E,null,512),[[n.F8,!P.score_show]])]),(0,i._)("div",$,[(0,i._)("div",F,[N,(0,i._)("span",null,"最终分数 : "+(0,o.zw)(P.myScore),1),(0,i._)("span",null,"比赛时间 : "+(0,o.zw)(P.Time)+"s",1)]),(0,i._)("div",Q,[G,(0,i._)("span",null,"最终分数 : "+(0,o.zw)(P.score),1),(0,i._)("span",null,"比赛时间 : "+(0,o.zw)(P.Time)+"s",1)])]),J,(0,i._)("div",V,[(0,i._)("button",{class:"btn",onClick:e[6]||(e[6]=(...s)=>R.matchUser&&R.matchUser(...s))},"再试一次")])])):(0,i.kq)("",!0)])}var R={name:"gameIndex",mounted(){null===this.socket&&this.connect()},watch:{myScore(){this.userInPlay()}},data(){return{v_box:1,v_show:!1,const_variable:{title:"玩家对战",title_2:["","匹配中..."],time:0,rule:"相同时间内,答题得分高的将获得胜利。需注意，提交错误将会扣除五分,不设上限，请认真思考后再进行提交。"},userId:null,socket:null,socketUrl:"ws://124.222.182.217:5003/game/match/",index:0,score:0,myScore:0,isDis:new Array(10).fill(!1),value:[],questions:[],score_show:!0,timeout:!1,time:0,Time:15,timeout2:!1}},methods:{init(){this.index=0,this.score=0,this.myScore=0,this.isDis=new Array(10).fill(!1),this.value=[]},preQuestion(){0===this.index?this.$message.warning("前面已经没有题目了！"):this.index--},nextQuestion(){9===this.index?this.$message.warning("已经是最后一题了！"):this.index++},commit(s){this.questions[s].ans===this.value[s]?(this.$message.success("true"),this.addScore(),this.isDis[s]=!0,this.index++):(this.$message.error("false"),this.reduceScore())},addScore(){this.myScore=this.myScore+10},reduceScore(){this.myScore=this.myScore-5},connect(){this.userId=this.UUid();let s=this.socketUrl+this.userId;this.socket=new WebSocket(s),this.socket.onopen=()=>{console.log("websocket 已打开 userId: "+this.userId)},this.socket.onmessage=s=>{let e="收到服务端信息: "+s.data;console.log(e);let t=JSON.parse(s.data)["chatMessage"];"MATCH_USER"===t["type"]?(this.questions=t["data"]["questions"],this.$message.success("已成功为你匹配到对手!"),this.timeout=!0,this.const_variable.time=0,this.time=this.Time,this.timeout2=!1,this.counter2(),this.v_box=2):"PLAY_GAME"===t["type"]?this.score=t["data"]["score"]:"GAME_OVER"===t["type"]&&(console.log("游戏结束!"),this.myScore>this.score?(this.v_box=3,this.score_show=!0):this.myScore<this.score?(this.v_box=3,this.score_show=!1):(this.v_box=3,this.score_show=!0))},this.socket.onclose=()=>{console.log("websocket 已关闭 userId: "+this.userId),this.socket=null},this.socket.onerror=()=>{console.log("websocket 发生了错误 userId : "+this.userId),console.log("重新链接"),this.connect()}},matchUser(){this.timeout=!1,this.counter(),null===this.socket&&this.$message.error("与服务器连接断开，请刷新页面..."),this.v_show=!this.v_show,this.isGameing=2,this.$message.info("开始匹配......");let s={},e=this.userId,t="MATCH_USER";s.sender=e,s.type=t,console.log("用户:"+e+"开始匹配......"),this.socket.send(JSON.stringify(s))},cancelMatch(){this.timeout=!0,this.const_variable.time=0,null===this.socket&&this.$message.error("与服务器连接断开，请刷新页面..."),this.v_show=!this.v_show,this.$message.info("取消匹配......");let s={},e=this.userId,t="CANCEL_MATCH";s.sender=e,s.type=t,console.log("用户:"+e+"取消匹配......"),this.socket.send(JSON.stringify(s))},userInPlay(){let s={},e=this.userId,t=this.myScore,i="PLAY_GAME";s.sender=e,s.data=t,s.type=i,console.log("用户:"+e+"更新分数为"+t),this.socket.send(JSON.stringify(s))},gameOver(){let s={},e=this.userId,t="GAME_OVER";s.sender=e,s.type=t,console.log("用户:"+e+"结束游戏"),this.socket.send(JSON.stringify(s))},UUid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(s){let e=16*Math.random()|0,t="x"==s?e:3&e|8;return t.toString(16)}))},counter(){if(!this.timeout)return this.const_variable.time=this.const_variable.time+1,setTimeout(this.counter,1e3)},counter2(){if(!this.timeout2)return this.time=this.time-1,0===this.time&&(this.timeout2=!0,this.gameOver()),setTimeout(this.counter2,1e3)}},unmounted(){this.gameOver()}},H=t(3744);const L=(0,H.Z)(R,[["render",P],["__scopeId","data-v-18c91b50"]]);var W=L}}]);
//# sourceMappingURL=453.e35c4311.js.map